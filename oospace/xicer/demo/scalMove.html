<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<meta name="renderer" content="webkit"/>
	<meta http-equiv="X-UA-Compatible" content="IE=11;IE=10;IE=9; IE=8;" /> 
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11;IE=EmulateIE10;IE=EmulateIE9;IE=EmulateIE8" />
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta http-equiv="Page-Exit" content="revealTrans(Duration=3,Transition=23)" >
    <title>拖拽缩放插件</title>
    <style>
    .showMax{
		padding:5px;
		padding-top:30px;
		border-radius:3px;
		position:fixed;
		z-index:999991;
		top:25%;
		left:50%;
		background-color:#dcdcdc;
		box-shadow:0px 0px 3px grey;
		border:1px solid #f5f5f5;
		cursor:move;
		}
		img{
			border-radius:2px;
		}
		.close{
		color:#ffffff;
		position:fixed;
		z-index:999992;
		width:14px;
		height:14px;
		top:25%;
		left:50%;
		margin-top:8px;
		cursor:pointer;
		}
		li >img:hover{
		border:1px solid orange;
		cursor:crosshair;
		}
		#Cover_Div{
		position: fixed;
		z-index: 9999;
		width: 100%;
		height: 100%;
		left: 0;
		top: 0;
		min-width: 700px;
		min-height: 740px;
		opacity: 0.5;
		filter: alpha(opacity = 50);
		background-color: #333333;
		display:none;
		}
		.cut{
		font-weight:bold;
		font-weight:normal\0;
		font-size:18px;
		height:30px;
		max-height:35px;
		color:#FFFFFF;
		font-family:楷书;
		}
    </style>
</head>
   <body>
		<img  onclick="showMax('images/demo.jpg')"  src="images/demo.jpg" style="width:490px;height:175px;cursor:crosshair;" />
		<div id="Cover_Div" onClick="hideMax()"></div>
   </body>
   <script src="js/jquery-1.10.2.min.js"></script>
   <script>
   function hideMax(){
	   $(".MAX_div").remove();
	   $("#Cover_Div").hide();
	   }
   //初始化点击图片后显示的默认宽度（像素）,默认缩放速度
  	var initWidth="490px",initHeight="175px",scal="10";
	var Wd=parseInt(initWidth)/parseInt(scal);
	var Ht=parseInt(initHeight)/parseInt(scal);
	var delet=parseInt(initWidth)/2-15;
	var added=parseInt(initWidth)/2+15;
	   var _enter=false;
	   
	   var scrollFunc = function (e) {
	   e = e || window.event;

	   //alert(Wd);
	   
	   
	   if(_enter){
	   if (e&&e.preventDefault){
	   e.preventDefault();
	   e.stopPropagation();
	   }else{
	   e.returnvalue=false;
	   }
	   }

	   var w=parseInt($(".showMax").css("width"));
	   var h=parseInt($(".showMax").css("height"));


	   if (e.wheelDelta&&_enter) { //判断浏览器IE，谷歌滑轮事件
	   if (e.wheelDelta > 0) { //当滑轮向上滚动时
	   $(".showMax").css({"width":w+Wd+"px","height":h+Ht+"px"});
	   $(".close").css("margin-left",(w-delet)<delet?delet:(w-delet)+"px");
	   }
	   if (e.wheelDelta < 0) { //当滑轮向下滚动时
	   $(".showMax").css({"width":(w-Wd)<parseInt(initWidth)?parseInt(initWidth):(w-Wd)+"px","height":(h-Ht)<parseInt(initHeight)?parseInt(initHeight):(h-Ht)+"px"});
	   $(".close").css("margin-left",(w-added-Wd)<delet?delet:(w-added-Wd)+"px");
	   }
	   } else if (e.detail&&_enter) { //Firefox滑轮事件
	   if (e.detail> 0) { //当滑轮向下滚动时
	   $(".showMax").css({"width":(w-Wd)<parseInt(initWidth)?parseInt(initWidth):(w-Wd)+"px","height":(h-Ht)<parseInt(initHeight)?parseInt(initHeight):(h-Ht)+"px"});
	   $(".close").css("margin-left",(w-added-Wd)<delet?delet:(w-added-Wd)+"px");
	   }
	   if (e.detail< 0) { //当滑轮向上滚动时

	   $(".showMax").css({"width":w+Wd+"px","height":h+Ht+"px"});
	   $(".close").css("margin-left",(w-delet)<delet?delet:(w-delet)+"px");
	   }
	   } } 
	   
	   
	   //给页面绑定滑轮滚动事件
	   if (document.addEventListener) {
	   //webkit
	   document.addEventListener('mousewheel', scrollFunc, false);
	   //firefox
	   document.addEventListener('DOMMouseScroll', scrollFunc, false);
	   }else if(window.attachEvent){
	   //IE
	   document.attachEvent('onmousewheel',scrollFunc);
	   }

	   function showMax(url){
	   $("#Cover_Div").show();
	   var Image=function(){
	   return document.createElement("img");
	   }
	   var DIV=function(){
	   return document.createElement("div");
	   }
	   var div=new DIV();
	   var close_div=new DIV();
	   var close_img=new Image();
	   var img=new Image();
	   
	   $(".MAX_div").remove();
	   div.setAttribute("class","MAX_div");
	   img.setAttribute("style","width:"+initWidth+";height:"+initHeight+";margin-left:-"+parseInt(initWidth)/2+"px;");
	   close_div.setAttribute("class","close");
	   close_div.setAttribute("style","margin-left:"+delet+"px;");
	   close_div.setAttribute("title","点击关闭");


	   img.setAttribute("class","showMax");
	   img.src=url;
	   close_img.src="images/delete.png";
	   img.onmouseover=function(){
	   _enter=true;
	   }
	   img.onmouseout=function(){
	   _enter=false;
	   }
	   close_div.onclick=function(){
	   hideMax();
	   }
	   close_div.appendChild(close_img);
	   div.appendChild(img);
	   div.appendChild(close_div);
	   document.body.appendChild(div);

	   //var _z=9999;
	   var close=$(".close");
	   $(document).ready(function(){
	   var _move=false;//移动标记
	   var _x,_y;//鼠标离控件左上角的相对位置
	   var wd;//窗口
	   $(".showMax").click(function(){
	   //alert("click");//点击（松开后触发）
	   //this.style.cursor = "default";//鼠标形状
	   //this.style.zIndex = 999;
	   }).mousedown(function(e){
	   _move=true;
	   wd=$(this);

	   //this.style.cursor = "move";//鼠标形状
	   // this.style.zIndex = _z;//窗口层次
	   // _z++;
	   _x=e.pageX-(isNaN(parseInt(wd.css("left")))?0:parseInt(wd.css("left")));
	   _y=e.pageY-(isNaN(parseInt(wd.css("top")))?0:parseInt(wd.css("top")));

	   c_x=e.pageX-(isNaN(parseInt(close.css("left")))?0:parseInt(close.css("left")));
	   c_y=e.pageY-(isNaN(parseInt(close.css("top")))?0:parseInt(close.css("top")));

	   //wd.fadeTo(20, 0.25); //点击后开始拖动并透明显示
	   $(document).mousemove(function(e){
	   if(_move){
	   var x=e.pageX-_x;//移动时根据鼠标位置计算控件左上角的绝对位置
	   var y=e.pageY-_y;

	   var closeX=e.pageX-c_x;
	   var closeY=e.pageY-c_y;
	   wd.css({top:y,left:x});//控件新位置
	   close.css({top:closeY,left:closeX});
	   }
	   }).mouseup(function(){
	   _move=false;
	   //wd.fadeTo("fast", 1); //松开鼠标后停止移动并恢复成不透明
	   });
	   });

	   });

	   //禁止拖动页面图片在新窗口打开
	   function imgdragstart(){return false;}
	   for(i in document.images)document.images[i].ondragstart=imgdragstart;
	   }
   </script>
</html>